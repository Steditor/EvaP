\tikzset{
	pics/sendPublishNotifications/.style args={}{
		code={
			\node[initial,state] (l1) {1};
			% grade_document_courses = grade_document_courses or []
			\node[state] (l2a) [below of=l1] {2};
			\node[state] (l2b) [below right of=l2a] {$2_\text{or}$};
			\node[state] (l2) [below left of=l2b] {$2_\text{=}$};
			
			% evaluation_results_courses = evaluation_results_courses or []
			\node[state] (l3a) [below of=l2] {3};
			\node[state] (l3b) [below right of=l3a] {$3_\text{or}$};
			\node[state] (l3) [below left of=l3b] {$3_\text{=}$};
			
			% publish_notifications = defaultdict(lambda: CourseLists(set(), set()))
			\node[state] (l5) [below of=l3] {5};
			
			% for course in evaluation_results_courses:
			\node[state, dummy] (l7) [below of=l5] {$7_\text{for}$};
			
			% implicit else
			\node[state] (l9-16-e) [below left of=l7] {$16_\text{else}$};
			% elif len(course.textanswer_set) > 0:
			\node[state] (l16) [left of=l9-16-e] {$16_\text{elif}$};
			% if course.can_publish_grades:
			\node[state] (l9) [left of=l16] {$9_\text{if}$};
			
			% for participant in course.participants.all():
			\node[state, dummy] (l10) [below left of=l9] {$10_\text{for}$};
			% publish_notifications[participant].evaluation_results_courses.add(course)
			\node[state] (l11) [below of=l10] {11};
			
			% for contribution in course.contributions.all():
			\node[state, dummy] (l12) [left of=l11] {$12_\text{for}$};
			
			% else empty
			\node[state] (l13-e) [below of=l12] {$13_\text{else}$};
			% if contribution.contributor:
			\node[state] (l13) [left of=l13-e] {$13_\text{if}$};
			% publish_notifications[contribution.contributor].evaluation_results_courses.add(course)
			\node[state] (l14) [below of=l13] {14};
			
			% for textanswer in course.textanswer_set:
			\node[state, dummy] (l17) [below of=l16] {$17_\text{for}$};
			% implicit else
			\node[state] (l18-e) [below of=l17] {$18_\text{else}$};
			% if textanswer.contribution.contributor:
			\node[state] (l18) [left of=l18-e] {$18_\text{if}$};
			%publish_notifications[textanswer.contribution.contributor].evaluation_results_courses.add(course)
			\node[state] (l19) [below of=l18] {19};
			
			% dummy for course in grade_document_courses:
			\node[state, dummy] (l21) [right=6cm of l9] {$21_\text{for}$};
			% dummy for participant in course.participants.all():
			\node[state, dummy] (l23) [below of=l21] {$23_\text{for}$};
			
			% else
			\node[state] (l24-e) [below of=l23] {$24_\text{else}$};
			% if participant.can_download_grades:
			\node[state] (l24) [left of=l24-e] {$24_\text{if}$};
			% publish_notifications[participant].grade_document_courses.add(course)
			\node[state] (l25) [below of=l24] {25};
			
			%publish_notifications[course.responsible_contributor].evaluation_results_courses.add(course)
			\node[state] (l20) at ($(l18-e)!0.5!(l24)$) {20};
			
			% for user, course_lists in publish_notifications.items()
			\node[state, dummy] (l27) [right of=l23] {$27_\text{for}$};
			% EmailTemplate.send_publish_notifications_to_user(
			% user,
			% grade_document_courses=list(course_lists.grade_document_courses),
			% evaluation_results_courses=list(course_lists.evaluation_results_courses)
			% )
			\node[state] (l28) [below of=l27] {28};
			% end
			\node[accepting, state] (l33) [right of=l28] {33};
			
			
			\path[->]
			(l1) edge (l2a)
			(l2) edge (l3a)
			(l3) edge (l5)
			(l5) edge (l7)
			(l7) edge (l21)
			(l7) edge [bend right=15] (l9)
			(l21) edge (l27)
			(l21) edge (l23)
			(l27) edge (l28)
			(l27) edge (l33)
			(l9) edge (l10)
			(l9) edge (l16)
			(l10) edge [bend left] (l11)
			(l10) edge (l12)
			(l11) edge [bend left] (l10)
			(l12) edge [bend left=45] (l7)
			(l12) edge (l13)
			(l16) edge (l9-16-e)
			(l16) edge (l17)
			(l9-16-e) edge (l7)
			(l13) edge (l13-e)
			(l13) edge (l14)
			(l13-e) edge [bend left] (l12)
			(l14) edge [bend right=75] (l12)
			(l17) edge (l18)
			(l17) edge [bend left] (l20)
			(l18) edge (l19)
			(l18) edge (l18-e)
			(l19) edge [bend right=75] (l17)
			(l18-e) edge [bend left] (l17)
			(l20) edge (l7)
			(l23) edge [bend left] (l21)
			(l23) edge (l24)
			(l24) edge (l24-e)
			(l24) edge (l25)
			(l25) edge [bend right=75] (l23)
			(l24-e) edge [bend left] (l23)
			(l28) edge [bend left] (l27)
			(l2a) edge (l2)
			(l2a) edge node[above right, midway] {\texttt{grade\_document\_courses = None}} (l2b)
			(l2b) edge (l2)
			(l3a) edge (l3)
			(l3a) edge node[above right, midway] {\texttt{evaluation\_results\_courses = None}} (l3b)
			(l3b) edge (l3);
		}
	}
}
